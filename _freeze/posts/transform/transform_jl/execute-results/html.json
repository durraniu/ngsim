{
  "hash": "de90b700806c77ca375599e0b67df7e9",
  "result": {
    "markdown": "---\ntitle: \"Transform Data with Julia\"\ndate: \"2024-03-10\"\ncategories: [import, transform, Tidier.jl]\nimage: \"Tidier_jl_logo.png\"\ncode-annotations: hover\nengine: jupyter\n---\n\n::: {.callout-note}\nThis is the second post in the NGSIM data analysis series. Previous post:   \n\n* [Import data](https://itav-ngsim.netlify.app/posts/import/import)  \n\n:::\n\n\n::: {.callout-tip}\n## After completing this post, you will be able to:\n\n* Read parquet files  \n* Do a quick clean-up of column names    \n* Convert integer time to datetime fromat  \n* Sort data by columns  \n* Create new columns  \n* Remove undesired columns  \n* Filter data  \n\n:::\n\n[This post shows code in `Julia`. You can see the same post written in `Python` [here](transform_py.qmd) and in `R` [here](transform_r.qmd).]{.aside}\n\nIn the previous post, we partitioned the Interstate 80 (I80) vehicle trajectories data by time and then saved it on disk:  \n\n![](i80_period.PNG)  \n\nWe now make use of the parquet file in the `period=first` directory for learning to transform data. Since this file is part of partitioned data, I saved it as a separate parquet file (`i80_period1.parquet`) in a different location.   \n\n\n## Load parquet file \n\nReading the parquet file requires the `Parquet2` package:  \n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\n# ] add Parquet2\nusing DataFrames\nusing Parquet2: Dataset\npath_to_first_period_file = \"data/i80_period1.parquet\"\ndata_jl = DataFrame(Dataset(path_to_first_period_file));\n\nfirst(data_jl, 5)\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div><div style = \"float: left;\"><span>5×24 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">Vehicle_ID</th><th style = \"text-align: left;\">Frame_ID</th><th style = \"text-align: left;\">Total_Frames</th><th style = \"text-align: left;\">Global_Time</th><th style = \"text-align: left;\">Local_X</th><th style = \"text-align: left;\">Local_Y</th><th style = \"text-align: left;\">Global_X</th><th style = \"text-align: left;\">Global_Y</th><th style = \"text-align: left;\">v_length</th><th style = \"text-align: left;\">v_Width</th><th style = \"text-align: left;\">v_Class</th><th style = \"text-align: left;\">v_Vel</th><th style = \"text-align: left;\">v_Acc</th><th style = \"text-align: left;\">Lane_ID</th><th style = \"text-align: left;\">O_Zone</th><th style = \"text-align: left;\">D_Zone</th><th style = \"text-align: left;\">Int_ID</th><th style = \"text-align: left;\">Section_ID</th><th style = \"text-align: left;\">Direction</th><th style = \"text-align: left;\">Movement</th><th style = \"text-align: left;\">Preceding</th><th style = \"text-align: left;\">Following</th><th style = \"text-align: left;\">Space_Headway</th><th style = \"text-align: left;\">Time_Headway</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Int64}\" style = \"text-align: left;\">Int64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: right;\">3027</td><td style = \"text-align: right;\">8493</td><td style = \"text-align: right;\">813</td><td style = \"text-align: right;\">1113433984200</td><td style = \"text-align: right;\">53.115</td><td style = \"text-align: right;\">363.266</td><td style = \"text-align: right;\">6.04284e6</td><td style = \"text-align: right;\">2.13343e6</td><td style = \"text-align: right;\">15.3</td><td style = \"text-align: right;\">7.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">21.46</td><td style = \"text-align: right;\">-8.14</td><td style = \"text-align: right;\">5</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"text-align: right;\">3014</td><td style = \"text-align: right;\">3032</td><td style = \"text-align: right;\">64.23</td><td style = \"text-align: right;\">2.99</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: right;\">3214</td><td style = \"text-align: right;\">9115</td><td style = \"text-align: right;\">708</td><td style = \"text-align: right;\">1113434046400</td><td style = \"text-align: right;\">67.931</td><td style = \"text-align: right;\">655.629</td><td style = \"text-align: right;\">6.04282e6</td><td style = \"text-align: right;\">2.13373e6</td><td style = \"text-align: right;\">13.8</td><td style = \"text-align: right;\">6.3</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">15.37</td><td style = \"text-align: right;\">11.2</td><td style = \"text-align: right;\">6</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"text-align: right;\">3221</td><td style = \"text-align: right;\">3229</td><td style = \"text-align: right;\">31.71</td><td style = \"text-align: right;\">2.06</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: right;\">3199</td><td style = \"text-align: right;\">9329</td><td style = \"text-align: right;\">575</td><td style = \"text-align: right;\">1113434067800</td><td style = \"text-align: right;\">17.026</td><td style = \"text-align: right;\">1237.59</td><td style = \"text-align: right;\">6.04268e6</td><td style = \"text-align: right;\">2.1343e6</td><td style = \"text-align: right;\">14.4</td><td style = \"text-align: right;\">5.9</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">39.3</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"text-align: right;\">3188</td><td style = \"text-align: right;\">3206</td><td style = \"text-align: right;\">72.36</td><td style = \"text-align: right;\">1.84</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: right;\">3159</td><td style = \"text-align: right;\">8919</td><td style = \"text-align: right;\">572</td><td style = \"text-align: right;\">1113434026800</td><td style = \"text-align: right;\">16.541</td><td style = \"text-align: right;\">306.905</td><td style = \"text-align: right;\">6.04281e6</td><td style = \"text-align: right;\">2.13337e6</td><td style = \"text-align: right;\">16.4</td><td style = \"text-align: right;\">5.9</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">14.71</td><td style = \"text-align: right;\">3.61</td><td style = \"text-align: right;\">2</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"text-align: right;\">3152</td><td style = \"text-align: right;\">3171</td><td style = \"text-align: right;\">51.9</td><td style = \"text-align: right;\">3.53</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: right;\">3314</td><td style = \"text-align: right;\">9324</td><td style = \"text-align: right;\">616</td><td style = \"text-align: right;\">1113434067300</td><td style = \"text-align: right;\">28.846</td><td style = \"text-align: right;\">65.807</td><td style = \"text-align: right;\">6.04285e6</td><td style = \"text-align: right;\">2.13314e6</td><td style = \"text-align: right;\">14.8</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">36.24</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">3</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"text-align: right;\">3301</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">103.26</td><td style = \"text-align: right;\">2.85</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## Clean dataframe names\n\nAs you can see above, the column names are in good shape i.e., without any spaces. However, it is easier typing lowercase letters than the sentence case. So, we use the `clean_names` macro from the `TidierData` package to make all column names lower case. If the column names have spaces or periods in them, `clean_names` would replace them with underscores.   \n\n::: {.cell execution_count=2}\n``` {.julia .cell-code}\nusing TidierData\ndata_jl = @clean_names(data_jl)\n\n@glimpse(data_jl)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1250932\nColumns: 24\n.vehicle_id    Union{Missing, Int32}3027, 3214, 3199, 3159, 3314, 3128, 3031, 29\n.frame_id      Union{Missing, Int32}8493, 9115, 9329, 8919, 9324, 9052, 9030, 86\n.total_frames  Union{Missing, Int32}813, 708, 575, 572, 616, 603, 958, 987, 760,\n.global_time   Union{Missing, Int64}1113433984200, 1113434046400, 1113434067800,\n.local_x       Union{Missing, Float64}53.115, 67.931, 17.026, 16.541, 28.846, 17\n.local_y       Union{Missing, Float64}363.266, 655.629, 1237.592, 306.905, 65.80\n.global_x      Union{Missing, Float64}6.042839372e6, 6.042817933e6, 6.042683444e\n.global_y      Union{Missing, Float64}2.133434927e6, 2.133726884e6, 2.134296961e\n.v_length      Union{Missing, Float64}15.3, 13.8, 14.4, 16.4, 14.8, 16.8, 15.3, \n.v_width       Union{Missing, Float64}7.4, 6.3, 5.9, 5.9, 6.4, 8.5, 7.4, 5.8, 8.\n.v_class       Union{Missing, Int32}2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,\n.v_vel         Union{Missing, Float64}21.46, 15.37, 39.3, 14.71, 36.24, 35.69, 2\n.v_acc         Union{Missing, Float64}-8.14, 11.2, 0.0, 3.61, 0.0, 11.2, 10.8, -\n.lane_id       Union{Missing, Int32}5, 6, 2, 2, 3, 2, 4, 4, 5, 5, 4, 6, 6, 2, 4,\n.o_zone        Union{Missing, Int32}missing, missing, missing, missing, missing,\n.d_zone        Union{Missing, Int32}missing, missing, missing, missing, missing,\n.int_id        Union{Missing, Int32}missing, missing, missing, missing, missing,\n.section_id    Union{Missing, Int32}missing, missing, missing, missing, missing,\n.direction     Union{Missing, Int32}missing, missing, missing, missing, missing,\n.movement      Union{Missing, Int32}missing, missing, missing, missing, missing,\n.preceding     Union{Missing, Int32}3014, 3221, 3188, 3152, 3301, 3125, 0, 2973,\n.following     Union{Missing, Int32}3032, 3229, 3206, 3171, 0, 3132, 3032, 2987,\n.space_headway Union{Missing, Float64}64.23, 31.71, 72.36, 51.9, 103.26, 90.81, \n.time_headway  Union{Missing, Float64}2.99, 2.06, 1.84, 3.53, 2.85, 2.54, 0.0, 3\n```\n:::\n:::\n\n\nThe `@glimpse` macro shows that all variable names are now in lower case now. But variables have the `Missing` type common. This is perhaps because some of the columns have missing values. Let's look at 2 variables:\n\n::: {.cell execution_count=3}\n``` {.julia .cell-code}\ncount(x -> ismissing(x), data_jl.frame_id)\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\n0\n```\n:::\n:::\n\n\n::: {.cell execution_count=4}\n``` {.julia .cell-code}\ncount(x -> ismissing(x), data_jl.o_zone)\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\n1250932\n```\n:::\n:::\n\n\nWe therefore remove all the columns that have missing values (completely missing!). Even after that, one of the *type* of the remaining variables is `Missing`. So, we replace missing values with zero just to change the type:\n\n::: {.cell execution_count=5}\n``` {.julia .cell-code}\ndata_jl = @select(data_jl, Not(:o_zone, :d_zone, :int_id, :section_id, :direction, :movement))\nfor col in names(data_jl)\n    data_jl[!, col] .= coalesce.(data_jl[!, col], 0)\nend\n```\n:::\n\n\n## How to create a time column?\n\nSince vehicle trajectories change over time, it is nice to see these changes over different time periods. However, the `gloabl_time` column in this dataset contains integers rather than the actual time. So, we create a new column called `actual_time` by dividing the `global_time` by 1000 and converting it to a datetime object.  \n\nIn Julia, this can be done via `Dates` package. The integer to datetime data conversion will report time in UTC. But the data were collected in Los Angeles, so we want to specify the `America/Los_Angeles` time zone. Thus, we subtract 7 hours as UTC is 7 hours ahead of PDT:\n\n::: {.cell execution_count=6}\n``` {.julia .cell-code}\nusing Dates\n\ndata_jl.actual_time = DateTime.(Dates.unix2datetime.(data_jl.global_time ./ 1000))\ndata_jl.actual_time = data_jl.actual_time .- Hour(7)\n\nfirst(data_jl, 5)\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div><div style = \"float: left;\"><span>5×19 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">vehicle_id</th><th style = \"text-align: left;\">frame_id</th><th style = \"text-align: left;\">total_frames</th><th style = \"text-align: left;\">global_time</th><th style = \"text-align: left;\">local_x</th><th style = \"text-align: left;\">local_y</th><th style = \"text-align: left;\">global_x</th><th style = \"text-align: left;\">global_y</th><th style = \"text-align: left;\">v_length</th><th style = \"text-align: left;\">v_width</th><th style = \"text-align: left;\">v_class</th><th style = \"text-align: left;\">v_vel</th><th style = \"text-align: left;\">v_acc</th><th style = \"text-align: left;\">lane_id</th><th style = \"text-align: left;\">preceding</th><th style = \"text-align: left;\">following</th><th style = \"text-align: left;\">space_headway</th><th style = \"text-align: left;\">time_headway</th><th style = \"text-align: left;\">actual_time</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int64\" style = \"text-align: left;\">Int64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"DateTime\" style = \"text-align: left;\">DateTime</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: right;\">3027</td><td style = \"text-align: right;\">8493</td><td style = \"text-align: right;\">813</td><td style = \"text-align: right;\">1113433984200</td><td style = \"text-align: right;\">53.115</td><td style = \"text-align: right;\">363.266</td><td style = \"text-align: right;\">6.04284e6</td><td style = \"text-align: right;\">2.13343e6</td><td style = \"text-align: right;\">15.3</td><td style = \"text-align: right;\">7.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">21.46</td><td style = \"text-align: right;\">-8.14</td><td style = \"text-align: right;\">5</td><td style = \"text-align: right;\">3014</td><td style = \"text-align: right;\">3032</td><td style = \"text-align: right;\">64.23</td><td style = \"text-align: right;\">2.99</td><td style = \"text-align: left;\">2005-04-13T16:13:04.200</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: right;\">3214</td><td style = \"text-align: right;\">9115</td><td style = \"text-align: right;\">708</td><td style = \"text-align: right;\">1113434046400</td><td style = \"text-align: right;\">67.931</td><td style = \"text-align: right;\">655.629</td><td style = \"text-align: right;\">6.04282e6</td><td style = \"text-align: right;\">2.13373e6</td><td style = \"text-align: right;\">13.8</td><td style = \"text-align: right;\">6.3</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">15.37</td><td style = \"text-align: right;\">11.2</td><td style = \"text-align: right;\">6</td><td style = \"text-align: right;\">3221</td><td style = \"text-align: right;\">3229</td><td style = \"text-align: right;\">31.71</td><td style = \"text-align: right;\">2.06</td><td style = \"text-align: left;\">2005-04-13T16:14:06.400</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: right;\">3199</td><td style = \"text-align: right;\">9329</td><td style = \"text-align: right;\">575</td><td style = \"text-align: right;\">1113434067800</td><td style = \"text-align: right;\">17.026</td><td style = \"text-align: right;\">1237.59</td><td style = \"text-align: right;\">6.04268e6</td><td style = \"text-align: right;\">2.1343e6</td><td style = \"text-align: right;\">14.4</td><td style = \"text-align: right;\">5.9</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">39.3</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">3188</td><td style = \"text-align: right;\">3206</td><td style = \"text-align: right;\">72.36</td><td style = \"text-align: right;\">1.84</td><td style = \"text-align: left;\">2005-04-13T16:14:27.800</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: right;\">3159</td><td style = \"text-align: right;\">8919</td><td style = \"text-align: right;\">572</td><td style = \"text-align: right;\">1113434026800</td><td style = \"text-align: right;\">16.541</td><td style = \"text-align: right;\">306.905</td><td style = \"text-align: right;\">6.04281e6</td><td style = \"text-align: right;\">2.13337e6</td><td style = \"text-align: right;\">16.4</td><td style = \"text-align: right;\">5.9</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">14.71</td><td style = \"text-align: right;\">3.61</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">3152</td><td style = \"text-align: right;\">3171</td><td style = \"text-align: right;\">51.9</td><td style = \"text-align: right;\">3.53</td><td style = \"text-align: left;\">2005-04-13T16:13:46.800</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: right;\">3314</td><td style = \"text-align: right;\">9324</td><td style = \"text-align: right;\">616</td><td style = \"text-align: right;\">1113434067300</td><td style = \"text-align: right;\">28.846</td><td style = \"text-align: right;\">65.807</td><td style = \"text-align: right;\">6.04285e6</td><td style = \"text-align: right;\">2.13314e6</td><td style = \"text-align: right;\">14.8</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">36.24</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">3</td><td style = \"text-align: right;\">3301</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">103.26</td><td style = \"text-align: right;\">2.85</td><td style = \"text-align: left;\">2005-04-13T16:14:27.300</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\nNote that the data is not in the correct order. The `vehicle_id`s in the first two rows are 3027 and 3214. However, we know that the same vehicle was observed for several seconds. This means that we should see a given `vehicle_id` repeated over multiple rows consecutively. We therefore sort by `vehicle_id` and `frame_id`:  \n\n::: {.cell execution_count=7}\n``` {.julia .cell-code}\n## First: Sort by Vehicle ID and Time\ndata_jl = @arrange(data_jl, vehicle_id, frame_id)\nfirst(data_jl, 5)\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div><div style = \"float: left;\"><span>5×19 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">vehicle_id</th><th style = \"text-align: left;\">frame_id</th><th style = \"text-align: left;\">total_frames</th><th style = \"text-align: left;\">global_time</th><th style = \"text-align: left;\">local_x</th><th style = \"text-align: left;\">local_y</th><th style = \"text-align: left;\">global_x</th><th style = \"text-align: left;\">global_y</th><th style = \"text-align: left;\">v_length</th><th style = \"text-align: left;\">v_width</th><th style = \"text-align: left;\">v_class</th><th style = \"text-align: left;\">v_vel</th><th style = \"text-align: left;\">v_acc</th><th style = \"text-align: left;\">lane_id</th><th style = \"text-align: left;\">preceding</th><th style = \"text-align: left;\">following</th><th style = \"text-align: left;\">space_headway</th><th style = \"text-align: left;\">time_headway</th><th style = \"text-align: left;\">actual_time</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int64\" style = \"text-align: left;\">Int64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"DateTime\" style = \"text-align: left;\">DateTime</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">12</td><td style = \"text-align: right;\">884</td><td style = \"text-align: right;\">1113433136100</td><td style = \"text-align: right;\">16.884</td><td style = \"text-align: right;\">48.213</td><td style = \"text-align: right;\">6.04284e6</td><td style = \"text-align: right;\">2.13312e6</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.100</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">13</td><td style = \"text-align: right;\">884</td><td style = \"text-align: right;\">1113433136200</td><td style = \"text-align: right;\">16.938</td><td style = \"text-align: right;\">49.463</td><td style = \"text-align: right;\">6.04284e6</td><td style = \"text-align: right;\">2.13312e6</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.200</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">14</td><td style = \"text-align: right;\">884</td><td style = \"text-align: right;\">1113433136300</td><td style = \"text-align: right;\">16.991</td><td style = \"text-align: right;\">50.712</td><td style = \"text-align: right;\">6.04284e6</td><td style = \"text-align: right;\">2.13312e6</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.300</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">15</td><td style = \"text-align: right;\">884</td><td style = \"text-align: right;\">1113433136400</td><td style = \"text-align: right;\">17.045</td><td style = \"text-align: right;\">51.963</td><td style = \"text-align: right;\">6.04284e6</td><td style = \"text-align: right;\">2.13312e6</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.400</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">16</td><td style = \"text-align: right;\">884</td><td style = \"text-align: right;\">1113433136500</td><td style = \"text-align: right;\">17.098</td><td style = \"text-align: right;\">53.213</td><td style = \"text-align: right;\">6.04284e6</td><td style = \"text-align: right;\">2.13312e6</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.500</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\nWhen we want to compare several vehicle trajectories, e.g., how their speeds change over time regardless of when they were observed, we'd want a common time scale. The NGSIM documentation describes that vehicles were observed at a resolution of 0.1 seconds. So, we can create a`time` variable for each vehicle that starts at 0 and ends at (n-1)/10 where n = number of rows for which a `vehicle_id` is repeated:  \n\n::: {.cell execution_count=8}\n``` {.julia .cell-code}\ndata_jl = @chain data_jl begin\n    @group_by(vehicle_id) # <1>\n    @mutate(time = (0:(first(n()) - 1))/10) # <2>\n    @ungroup() # <3>\nend;\n```\n:::\n\n\n1. Group by `vehicle_id` so that `time` is calculated for each vehicle separately.  \n2. `n()` gives the group size.  \n3. Don't forget to `ungroup`.  \n\n\n\n## How to create variables for the preceding vehicle?\n\nWe'd often need velocity, acceleration, and other variables for the preceding vehicle (vehicle in front of the subject vehicle). These variables can be useful in car-following modeling.   \n\nIn this dataset, preceding vehicle variables do not exist as separate columns. The only relevant column is `preceding` which is the identifier of the preceding vehicle. But the data also contains the subject vehicle identifier `vehicle_id`, along with these variables:  \n\n* `local_y`: longitudinal position of the front end of the subject vehicle (feet)     \n* `local_x`: lateral position of the front end of the subject vehicle (feet)  \n* `v_length` and `v_width` are the length and width of the subject vehicle (feet)  \n* `v_class` is the class of the subject vehicle, i.e., 1 = motorcycle, 2 = car, and 3 = heavy vehicle (bus/truck)  \n* `v_vel` and `v_acc` are the velocity (ft/s) and acceleration (ft/s/s) of the subject vehicle  \n\nOur goal now is to create new columns of the above variables for the preceding vehicle. To this end, we look for the value of `preceding` in the `vehicle_id` column at a given value of `frame_id` (identifier of time frame) and then grab the value of variable e.g., `v_vel` at that `frame_id`. In Julia, we achieve this by joining a few columns of the dataset with the full dataset while using the columns `vehicle_id` and `preceding` for the join:  \n\n::: {.cell execution_count=9}\n``` {.julia .cell-code}\n# Join\ndata_jl = leftjoin(\n           data_jl,\n           data_jl[:, [:frame_id, :vehicle_id, :local_y, :v_length, :v_width, :v_class, :v_vel, :v_acc]],\n           on = [:frame_id => :frame_id, :preceding => :vehicle_id],\n           makeunique = true, \n           renamecols = \"\" => \"_preceding\"\n       )\n\n# Arrange again\ndata_jl = @arrange(data_jl, vehicle_id, frame_id)\n\n\n# Rename columns to match with naming in R and Python posts\ndata_jl = @chain data_jl begin\n    @rename(preceding_local_y = local_y_preceding,\n            preceding_length =  v_length_preceding,\n            preceding_width = v_width_preceding,\n            preceding_class = v_class_preceding,\n            preceding_vel = v_vel_preceding,\n            preceding_acc = v_acc_preceding)\nend\n\nfirst(data_jl, 5)\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<div><div style = \"float: left;\"><span>5×26 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">vehicle_id</th><th style = \"text-align: left;\">frame_id</th><th style = \"text-align: left;\">total_frames</th><th style = \"text-align: left;\">global_time</th><th style = \"text-align: left;\">local_x</th><th style = \"text-align: left;\">local_y</th><th style = \"text-align: left;\">global_x</th><th style = \"text-align: left;\">global_y</th><th style = \"text-align: left;\">v_length</th><th style = \"text-align: left;\">v_width</th><th style = \"text-align: left;\">v_class</th><th style = \"text-align: left;\">v_vel</th><th style = \"text-align: left;\">v_acc</th><th style = \"text-align: left;\">lane_id</th><th style = \"text-align: left;\">preceding</th><th style = \"text-align: left;\">following</th><th style = \"text-align: left;\">space_headway</th><th style = \"text-align: left;\">time_headway</th><th style = \"text-align: left;\">actual_time</th><th style = \"text-align: left;\">time</th><th style = \"text-align: left;\">preceding_local_y</th><th style = \"text-align: left;\">preceding_length</th><th style = \"text-align: left;\">preceding_width</th><th style = \"text-align: left;\">preceding_class</th><th style = \"text-align: left;\">preceding_vel</th><th style = \"text-align: left;\">preceding_acc</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int64\" style = \"text-align: left;\">Int64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"DateTime\" style = \"text-align: left;\">DateTime</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">12</td><td style = \"text-align: right;\">884</td><td style = \"text-align: right;\">1113433136100</td><td style = \"text-align: right;\">16.884</td><td style = \"text-align: right;\">48.213</td><td style = \"text-align: right;\">6.04284e6</td><td style = \"text-align: right;\">2.13312e6</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.100</td><td style = \"text-align: right;\">0.0</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">13</td><td style = \"text-align: right;\">884</td><td style = \"text-align: right;\">1113433136200</td><td style = \"text-align: right;\">16.938</td><td style = \"text-align: right;\">49.463</td><td style = \"text-align: right;\">6.04284e6</td><td style = \"text-align: right;\">2.13312e6</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.200</td><td style = \"text-align: right;\">0.1</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">14</td><td style = \"text-align: right;\">884</td><td style = \"text-align: right;\">1113433136300</td><td style = \"text-align: right;\">16.991</td><td style = \"text-align: right;\">50.712</td><td style = \"text-align: right;\">6.04284e6</td><td style = \"text-align: right;\">2.13312e6</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.300</td><td style = \"text-align: right;\">0.2</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">15</td><td style = \"text-align: right;\">884</td><td style = \"text-align: right;\">1113433136400</td><td style = \"text-align: right;\">17.045</td><td style = \"text-align: right;\">51.963</td><td style = \"text-align: right;\">6.04284e6</td><td style = \"text-align: right;\">2.13312e6</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.400</td><td style = \"text-align: right;\">0.3</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">16</td><td style = \"text-align: right;\">884</td><td style = \"text-align: right;\">1113433136500</td><td style = \"text-align: right;\">17.098</td><td style = \"text-align: right;\">53.213</td><td style = \"text-align: right;\">6.04284e6</td><td style = \"text-align: right;\">2.13312e6</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.500</td><td style = \"text-align: right;\">0.4</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\nIn this dataset, `missing` indicates that the value is missing because there was no preceding vehicle observed. For `vehicle_id` 1 we can see this is true because the `preceding` value is 0.  \n\n\n\n## How to remove undesired columns?\n\nThere are several variables in this dataset that we don't need as they are completely devoid of any value. We have removed those variables already. We further remove variables that we don't need for analysis:  \n\n::: {.cell execution_count=10}\n``` {.julia .cell-code}\ndata_jl = @select(data_jl, Not(:total_frames, starts_with(\"global\"), :following))\nfirst(data_jl, 5)\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```{=html}\n<div><div style = \"float: left;\"><span>5×21 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">vehicle_id</th><th style = \"text-align: left;\">frame_id</th><th style = \"text-align: left;\">local_x</th><th style = \"text-align: left;\">local_y</th><th style = \"text-align: left;\">v_length</th><th style = \"text-align: left;\">v_width</th><th style = \"text-align: left;\">v_class</th><th style = \"text-align: left;\">v_vel</th><th style = \"text-align: left;\">v_acc</th><th style = \"text-align: left;\">lane_id</th><th style = \"text-align: left;\">preceding</th><th style = \"text-align: left;\">space_headway</th><th style = \"text-align: left;\">time_headway</th><th style = \"text-align: left;\">actual_time</th><th style = \"text-align: left;\">time</th><th style = \"text-align: left;\">preceding_local_y</th><th style = \"text-align: left;\">preceding_length</th><th style = \"text-align: left;\">preceding_width</th><th style = \"text-align: left;\">preceding_class</th><th style = \"text-align: left;\">preceding_vel</th><th style = \"text-align: left;\">preceding_acc</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"DateTime\" style = \"text-align: left;\">DateTime</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">12</td><td style = \"text-align: right;\">16.884</td><td style = \"text-align: right;\">48.213</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.100</td><td style = \"text-align: right;\">0.0</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">13</td><td style = \"text-align: right;\">16.938</td><td style = \"text-align: right;\">49.463</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.200</td><td style = \"text-align: right;\">0.1</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">14</td><td style = \"text-align: right;\">16.991</td><td style = \"text-align: right;\">50.712</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.300</td><td style = \"text-align: right;\">0.2</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">15</td><td style = \"text-align: right;\">17.045</td><td style = \"text-align: right;\">51.963</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.400</td><td style = \"text-align: right;\">0.3</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">16</td><td style = \"text-align: right;\">17.098</td><td style = \"text-align: right;\">53.213</td><td style = \"text-align: right;\">14.3</td><td style = \"text-align: right;\">6.4</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">12.5</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.500</td><td style = \"text-align: right;\">0.4</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## How to transform multiple columns?\n\n### Metric units\n\n![](https://media.giphy.com/media/xUPGcAx3wr7jszFfpe/giphy.gif)\n\nAs discussed before, variables in this dataset have imperial units (feet, ft/s, etc.). You may want to transform the values of these variables to metric units. The conversion factor is 0.3048. Here, we write a function to take a column and apply the conversion factor along with rounding to 2 decimal places:  \n\n::: {.cell execution_count=11}\n``` {.julia .cell-code}\n## metric units\nfunction convert_and_round(x)\n    return round(x * 0.3048, digits=2)\nend\n\ncols_to_mutate = [\"local_x\", \"local_y\", \"v_length\", \"v_width\", \n                 \"v_vel\", \"v_acc\", \"space_headway\",\n                 \"preceding_local_y\", \"preceding_length\", \"preceding_width\",\n                 \"preceding_vel\", \"preceding_acc\"]\n\nfor col in cols_to_mutate\n    data_jl[!, col] .= convert_and_round.(data_jl[!, col])\nend\n\nfirst(data_jl, 5)\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```{=html}\n<div><div style = \"float: left;\"><span>5×21 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">vehicle_id</th><th style = \"text-align: left;\">frame_id</th><th style = \"text-align: left;\">local_x</th><th style = \"text-align: left;\">local_y</th><th style = \"text-align: left;\">v_length</th><th style = \"text-align: left;\">v_width</th><th style = \"text-align: left;\">v_class</th><th style = \"text-align: left;\">v_vel</th><th style = \"text-align: left;\">v_acc</th><th style = \"text-align: left;\">lane_id</th><th style = \"text-align: left;\">preceding</th><th style = \"text-align: left;\">space_headway</th><th style = \"text-align: left;\">time_headway</th><th style = \"text-align: left;\">actual_time</th><th style = \"text-align: left;\">time</th><th style = \"text-align: left;\">preceding_local_y</th><th style = \"text-align: left;\">preceding_length</th><th style = \"text-align: left;\">preceding_width</th><th style = \"text-align: left;\">preceding_class</th><th style = \"text-align: left;\">preceding_vel</th><th style = \"text-align: left;\">preceding_acc</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"DateTime\" style = \"text-align: left;\">DateTime</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Int32}\" style = \"text-align: left;\">Int32?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">12</td><td style = \"text-align: right;\">5.15</td><td style = \"text-align: right;\">14.7</td><td style = \"text-align: right;\">4.36</td><td style = \"text-align: right;\">1.95</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">3.81</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.100</td><td style = \"text-align: right;\">0.0</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">13</td><td style = \"text-align: right;\">5.16</td><td style = \"text-align: right;\">15.08</td><td style = \"text-align: right;\">4.36</td><td style = \"text-align: right;\">1.95</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">3.81</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.200</td><td style = \"text-align: right;\">0.1</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">14</td><td style = \"text-align: right;\">5.18</td><td style = \"text-align: right;\">15.46</td><td style = \"text-align: right;\">4.36</td><td style = \"text-align: right;\">1.95</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">3.81</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.300</td><td style = \"text-align: right;\">0.2</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">15</td><td style = \"text-align: right;\">5.2</td><td style = \"text-align: right;\">15.84</td><td style = \"text-align: right;\">4.36</td><td style = \"text-align: right;\">1.95</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">3.81</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.400</td><td style = \"text-align: right;\">0.3</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: right;\">1</td><td style = \"text-align: right;\">16</td><td style = \"text-align: right;\">5.21</td><td style = \"text-align: right;\">16.22</td><td style = \"text-align: right;\">4.36</td><td style = \"text-align: right;\">1.95</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">3.81</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">2</td><td style = \"text-align: right;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.500</td><td style = \"text-align: right;\">0.4</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n### Convert numbers to string data type\n\nMoreover, we know that there are variables that should be treated as categorical (qualitative) rather than numbers. For instance, `lane_id` has values 1-7 and we know that these are identifiers for lanes. Similarly, the class of a vehicle is encoded as 1, 2, and 3 but we know that these numbers do not have any quantitaive information, rather they are categories.   \n\nWe use the `string` function to convert numbers to string data type:    \n\n::: {.cell execution_count=12}\n``` {.julia .cell-code}\ndata_jl[!,:vehicle_id] = string.(data_jl[!,:vehicle_id])\ndata_jl[!,:v_class] = string.(data_jl[!,:v_class])\ndata_jl[!,:lane_id] = string.(data_jl[!,:lane_id])\ndata_jl[!,:preceding] = string.(data_jl[!,:preceding])\ndata_jl[!,:preceding_class] = string.(data_jl[!,:preceding_class])\n\nfirst(data_jl, 5)\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```{=html}\n<div><div style = \"float: left;\"><span>5×21 DataFrame</span></div><div style = \"clear: both;\"></div></div><div class = \"data-frame\" style = \"overflow-x: scroll;\"><table class = \"data-frame\" style = \"margin-bottom: 6px;\"><thead><tr class = \"header\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">Row</th><th style = \"text-align: left;\">vehicle_id</th><th style = \"text-align: left;\">frame_id</th><th style = \"text-align: left;\">local_x</th><th style = \"text-align: left;\">local_y</th><th style = \"text-align: left;\">v_length</th><th style = \"text-align: left;\">v_width</th><th style = \"text-align: left;\">v_class</th><th style = \"text-align: left;\">v_vel</th><th style = \"text-align: left;\">v_acc</th><th style = \"text-align: left;\">lane_id</th><th style = \"text-align: left;\">preceding</th><th style = \"text-align: left;\">space_headway</th><th style = \"text-align: left;\">time_headway</th><th style = \"text-align: left;\">actual_time</th><th style = \"text-align: left;\">time</th><th style = \"text-align: left;\">preceding_local_y</th><th style = \"text-align: left;\">preceding_length</th><th style = \"text-align: left;\">preceding_width</th><th style = \"text-align: left;\">preceding_class</th><th style = \"text-align: left;\">preceding_vel</th><th style = \"text-align: left;\">preceding_acc</th></tr><tr class = \"subheader headerLastRow\"><th class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\"></th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"Int32\" style = \"text-align: left;\">Int32</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"DateTime\" style = \"text-align: left;\">DateTime</th><th title = \"Float64\" style = \"text-align: left;\">Float64</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"String\" style = \"text-align: left;\">String</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th><th title = \"Union{Missing, Float64}\" style = \"text-align: left;\">Float64?</th></tr></thead><tbody><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">1</td><td style = \"text-align: left;\">1</td><td style = \"text-align: right;\">12</td><td style = \"text-align: right;\">5.15</td><td style = \"text-align: right;\">14.7</td><td style = \"text-align: right;\">4.36</td><td style = \"text-align: right;\">1.95</td><td style = \"text-align: left;\">2</td><td style = \"text-align: right;\">3.81</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2</td><td style = \"text-align: left;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.100</td><td style = \"text-align: right;\">0.0</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"text-align: left;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">2</td><td style = \"text-align: left;\">1</td><td style = \"text-align: right;\">13</td><td style = \"text-align: right;\">5.16</td><td style = \"text-align: right;\">15.08</td><td style = \"text-align: right;\">4.36</td><td style = \"text-align: right;\">1.95</td><td style = \"text-align: left;\">2</td><td style = \"text-align: right;\">3.81</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2</td><td style = \"text-align: left;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.200</td><td style = \"text-align: right;\">0.1</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"text-align: left;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">3</td><td style = \"text-align: left;\">1</td><td style = \"text-align: right;\">14</td><td style = \"text-align: right;\">5.18</td><td style = \"text-align: right;\">15.46</td><td style = \"text-align: right;\">4.36</td><td style = \"text-align: right;\">1.95</td><td style = \"text-align: left;\">2</td><td style = \"text-align: right;\">3.81</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2</td><td style = \"text-align: left;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.300</td><td style = \"text-align: right;\">0.2</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"text-align: left;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">4</td><td style = \"text-align: left;\">1</td><td style = \"text-align: right;\">15</td><td style = \"text-align: right;\">5.2</td><td style = \"text-align: right;\">15.84</td><td style = \"text-align: right;\">4.36</td><td style = \"text-align: right;\">1.95</td><td style = \"text-align: left;\">2</td><td style = \"text-align: right;\">3.81</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2</td><td style = \"text-align: left;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.400</td><td style = \"text-align: right;\">0.3</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"text-align: left;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr><tr><td class = \"rowNumber\" style = \"font-weight: bold; text-align: right;\">5</td><td style = \"text-align: left;\">1</td><td style = \"text-align: right;\">16</td><td style = \"text-align: right;\">5.21</td><td style = \"text-align: right;\">16.22</td><td style = \"text-align: right;\">4.36</td><td style = \"text-align: right;\">1.95</td><td style = \"text-align: left;\">2</td><td style = \"text-align: right;\">3.81</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2</td><td style = \"text-align: left;\">0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: right;\">0.0</td><td style = \"text-align: left;\">2005-04-13T15:58:56.500</td><td style = \"text-align: right;\">0.4</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"text-align: left;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td><td style = \"font-style: italic; text-align: right;\">missing</td></tr></tbody></table></div>\n```\n:::\n:::\n\n\n## Visualization with one vehicle\n\nCool! We are almost done with transforming our dataset. It is time to do some visualization. The last transformation we learn is to filter the data to keep only one vehicle:  \n\n::: {.cell execution_count=13}\n``` {.julia .cell-code}\ndata_jl_veh = @filter(data_jl, vehicle_id == \"2\");\n```\n:::\n\n\nAnd now we use `TidierPlots` to create a plot of velocity over time. Subject vehicle in blue and preceding vehicle in orange.  \n\n::: {.cell execution_count=14}\n``` {.julia .cell-code}\nusing TidierPlots\nggplot(data = data_jl_veh) +\n  geom_path(aes(x = \"time\", y = \"v_vel\"), color = \"blue\") +\n  geom_path(aes(x = \"time\", y = \"preceding_vel\"), color = \"orange\") +\n  labs(x = \"Time (s)\", y = \"Velocity (m/s)\",\n       title = \"Velocity of vehicle # 2 and its preceding vehicle\") +\n  theme_minimal()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nheight: 400\nx: Time (s)\ntitle: Velocity of vehicle # 2 and its preceding vehicle\nwidth: 600\ny: Velocity (m/s)\n\ngeom_path\ndata: inherits from plot\nx: time \ny: v_vel \n\ngeom_path\ndata: inherits from plot\nx: time \ny: preceding_vel \n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](transform_jl_files/figure-html/cell-15-output-2.png){}\n:::\n\n::: {.cell-output .cell-output-display execution_count=15}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span style=\"text-decoration:underline\">ggplot options</span>\n<span class=\"ansi-blue-fg\">data: A DataFrame (415 rows, 21 columns)</span>\n</pre>\n```\n:::\n\n:::\n:::\n\n\nAs you see, the lead vehicle speed is not seen after about 17 seconds. This is because the lead vehicle changed lanes.  \n\n",
    "supporting": [
      "transform_jl_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}